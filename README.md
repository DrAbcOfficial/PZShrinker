# PZTextureShrinker

一个用于游戏Project Zomboid批量读取贴图位置并调整尺寸的工具

## 为什么编写本工具

一个个Mod作者在这个人物只有鼻屎大的游戏里塞满了**16344**x**16344**尺寸的纹理，用16K钛合金超高清大图把小浣熊的绿皮游戏变成劲爆12345A级超级大作，结果就是我的，16GB 内存，AMD 核显，轻薄本，在加载几个 Mod 后直接原地升天。


## 为什么不加内存

内存比金条还贵。

## 小浣熊可以指定最大贴图大小，为什么还需要本工具？

实际上，小浣熊的选项压根不起作用。但是我没有开发过Java，也没有做过几次JVM逆向，更没有对小浣熊的代码进行深潜。

我猜测可能有以下原因：
- 小浣熊缩放完贴图向OpenGL上传后没释放原来的贴图。
- 小浣熊那个选项压根不是预先缩放贴图，而是一个着色器将显存里的大贴图弄成小图渲染。

因此，最稳妥的方式是在 Mod 文件层面就将贴图缩小

## 使用方法

```bash
./PZTextureShrinker <你的僵毁SteamWorkShop路径> -max 128 -min 32 -sr 0.25 -it -mt
```

## 可用变量

|变量|别名|描述|默认值|
|:----|:----|:----|:----|
| `-max` | `--max-size` | 指定最大允许的贴图尺寸 | 默认512|
| `-min` | `--min-size` | 小于这个尺寸的贴图不缩放 | 默认64|
| `-sr` | `--scale-ratio` | 缩放比例，一般在0到1之间，当然你可以填大于1的数，把所有的贴图都变成24K钛合金图| 默认0.25|

## 可用开关

|开关|别名|描述|默认值|
|:----|:----|:----|:----|
| `-it` | `--icon-texture`| 缩放图标，就是你物品栏那个|关闭|
| `-mt` | `--model-texture` | 缩放角色/物品/衣服/车辆模型纹理|关闭|
| `-tp` | `--tiles-pack` | 缩放地图纹理，不推荐开启，缩放后Offset必定会有偏差，重新映射到游戏尺寸后误差传递会很夸张|关闭|
| `-all` | `--all-texture` | 缩放所有Png，不推荐开启，会导致文字tiles全部混乱，除非你实在没办法决定来一把梭哈|关闭|


## 建议搭配

在`ProjectZomboid64.json`中加上启动参数`-XX:+UseCompactObjectHeaders`使用紧凑头，我不知道小浣熊为什么搭配了一个JVM25却默认不开启，正如我所说，我没有开发过Java
